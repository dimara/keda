{% extends "base.html" %}

{% block title %}Reservations{% endblock %}

{% block content %}
    <form class="form" role="form" action="/reservations/" method="GET">
      {% include "includes/dates.html" %}
      {% include "includes/reservation_filter.html" %}
      <div class="row">
        {% include "includes/search_filter.html" %}


    <div class="col-md-1">
      <div class="checkbox">
      <label>
        <input id="errors" type="checkbox" name="errors">Errors
      </label>
      </div>
    </div>
          <div class="col-md-3 col-md-offset-4">
      <div class="form-group"> 
      <select class="form-control" name="order" style="">
          <option value="">Order by</option>
          <option value="name">Name</option>
          <option value="apartment">Apartment</option>
      </select>
      </div>
      </div>
      </div>
    </form>



    {% include "includes/info.html" %}
    <table  id="table" class="table table-hover">
      <tr id="titles">
        <th></th>
        <th>Visitor</th>
        <th>Agent</th>
        <th>Period</th>
        <th>Appartment</th>
        <th>Type</th>
        <th>Payed</th>
        <th></th>
      </tr>
      {% for r in reservations %}
        <tr {% if r.notifications.1 %} class="danger" {% elif r.notifications.0 %} class="nodanger" {% else %} class="ok" {% endif %}>
            <td>
              {{ forloop.counter }}
            </td>
            <td>
                    <a target="_blank" href="/admin/reception/militaryperson/{{ r.owner.id }}/">{{ r.owner.info }}</a>
                    {% include "includes/status.html" %}
            </td>
            <td> {{ r.get_agent_display }} </td>
            <td>
                    <a href="/admin/reception/reservation/{{ r.id }}/">{{ r.period }}</a>
            </td>
            <td>
                <span rel="tooltip" title="Rooms:{{ r.appartment.rooms }}  | Beds:{{ r.appartment.beds }}">
                    <a target="_blank" href="/admin/reception/appartment/{{ r.appartment.id }}/">{{ r.appartment }}</a>
                </span>
            </td>
            <td> {{ r.get_res_type_display }} </td>
            <td> {{ r.receipt.no }} </td>
            <td>
              {% if r.notifications.0 %}
                  <span rel="tooltip" class="n{{ r.notifications.0|join:" n" }}"> <span class="badge badge-important">E</span> </span>
              {% endif %}
            </td>
        </tr>
      {% endfor %}
    </table>

{% endblock %}
