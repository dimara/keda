{% extends "base.html" %}

{% block title %}Search for Available Appartments{% endblock %}
{% block content %}
    <form action="/availability/" method="get">
      <div class="row"> 
        <div class="col-md-6">
                {% if date_errors %}
                <div class="alert alert-danger" ><button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>{{ date_errors }} </div> 
                {% endif %}
        </div>
      </div>
        {% include "includes/dates.html" %}
        {% include "includes/apartment_filter.html" %}
        <div class="orderfixed">
        {% include "includes/search_filter.html" %}
        </div>

    </form>
      {% include "includes/info.html" %}
      <form class="form" role="form" action="/availability/" method="GET">
  <div class="col-md-3" id="sbox">
  <input class="form-control" tabindex=1 type="search" id ="search" size="20" placeholder="Type to filter" />
  </div>
</form>

      <table class="table table-hover" id="table">
        <tr id="titles">
          <th></th>
          <th>Appartment</th>
          <th>Rooms</th>
          <th>Beds</th>
          <th>Category</th>
          <th>Damages</th>
          <th></th>
        </tr>
        {% for a, res in avail %}
        <tr>
          <td>{{ forloop.counter }}</td>
          <td> <a target="_blank" href="/admin/reception/appartment/{{ a.id }}/">{{ a }}</a> </td>
          <td>{{ a.rooms }}</td>
          <td>{{ a.beds }}</td>
          <td>{{ a.category }}</td>
          <td>
            {% for d in a.damages.all %}
              {% if not d.fixed %}
                {{ d.tag }},
              {% endif %}
            {% endfor %}
          </td>
          <td>
            {% for r in res %}
                {{ r.period }} - {{ r.owner.info }} - {{ r.get_status_display }}<br>
            {% endfor %}
          </td>


        </tr>
        {% endfor %}
      </table>   
{% endblock %}
