{% extends "base.html" %}

{% block title %}Search for Available Appartments{% endblock %}
{% block content %}
    <form action="/availability/" method="get">
        {% include "includes/dates.html" %}
        {% include "includes/apartment_filter.html" %}
        {% include "includes/search_filter.html" %}

    </form>
      {% include "includes/errors.html" %}
      {% include "includes/filter.html" %}
      {% include "includes/info.html" %}

      <table class="table table-hover" id="table">
        <tr id="titles">
          <th></th>
          <th>Appartment</th>
          <th>Rooms</th>
          <th>Beds</th>
          <th>Category</th>
          <th>Damages</th>
          <th></th>
        </tr>
        {% for a, res in avail %}
        <tr>
          <td>{{ forloop.counter }}</td>
          <td> <a target="_blank" href="/admin/reception/appartment/{{ a.id }}/">{{ a }}</a> </td>
          <td>{{ a.rooms }}</td>
          <td>{{ a.beds }}</td>
          <td>{{ a.category }}</td>
          <td>
            {% for d in a.damages.all %}
              {% if not d.fixed %}
                {{ d.tag }},
              {% endif %}
            {% endfor %}
          </td>
          <td>
            {% for r in res %}
                <a target="_blank" href="/admin/reception/reservation/{{ r.id }}/">{{ r.get_res_type_display }} - {{ r.period }} - {{ r.owner.info }} - {{ r.get_status_display }}</a><br>
            {% endfor %}
          </td>


        </tr>
        {% endfor %}
      </table>   
{% endblock %}
