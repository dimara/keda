{% extends "base.html" %}

{% block title %}Reservations{% endblock %}

{% block content %}
    <h3>Reservations</h3><br>
    <form action="/reservations/" method="GET">
      {% include "includes/dates.html" %}
      {% include "includes/reservation_filter.html" %}
      {% include "includes/search_filter.html" %}
    </form>
    {% include "includes/info.html" %}
    <table  id="table" class="table table-hover">
      <tr id="titles">
        <th></th>
        <th>Visitor</th>
        <th>Relatives</th>
        <th>Vehicles</th>
        <th>Contacts</th>
        <th>Period</th>
        <th>Appartment</th>
        <th>Type</th>
        <th>Payed</th>
      </tr>
      {% for r in reservations %}
      <tr>
        <td>{{ forloop.counter }}</td>
        <td>
            {% if r.owner.militaryperson %}
                {% if r.owner.militaryperson.visitor %}
                    <a href="/admin/reception/visitor/{{ r.owner.id }}/">{{ r.owner.militaryperson.visitor.info }}</a >
                {% else %}
                    <a href="/admin/reception/militaryperson/{{ r.owner.id }}/">{{ r.owner.militaryperson.info }}</a >
                {% endif %}

            {% else %}
                <a href="/admin/reception/person/{{ r.owner.id }}/">{{ r.owner.militaryperson.info }}</a >
            {% endif %}
            {% if r.status = "PENDING" %}<span class="label label-warning">Pending</span>{% endif %}
            {% if r.status = "CANCELED" %}<span class="label label-important">Canceled</span>{% endif %}
        </td>

        <td>
        {% for rr in r.owner.relatives.all %}
          {{ rr }}<br>
        {% endfor %}
        </td>
        <td>
        {% for v in r.owner.vehicles.all %}
          {{ v.plate }}<br>
        {% endfor %}
        </td>
        <td>
        {% for c in r.owner.contacts.all %}
          {{ c.mobile }}<br>
        {% endfor %}
        </td>
        <td><a href="/admin/reception/reservation/{{ r.id }}/">{{ r.period }}</a></td>
        <td> <a href="/admin/reception/appartment/{{ r.appartment.id }}/">{{ r.appartment }}</a> </td>
        <td>{{ r.res_type }}</td>
        <td>
        {% for p in r.receipts.all %}
          {{ p.no }}<br>
        {% endfor %}
        </td>
      {% endfor %}
    </table>
{% endblock %}
